<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能衣櫥 - Smartfit</title>
    <link rel="stylesheet" href="02.css" />
    
</head>
<body>
    <header>
        <h1>智能衣櫥 - Smartfit</h1>
    </header>
    
    <nav>
        <button id="btn-weather" class="active">天氣穿搭</button>
        <button id="btn-personal">個人衣櫥</button>
        <button id="btn-database">資料庫衣櫥</button>
        <button id="btn-outfit">我的搭配</button>
    </nav>
    
    <main>
        <!-- 天氣穿搭頁面 -->
        <div id="weather-tab" class="tab-content active">
            <div class="container">
                <h2>天氣穿搭推薦</h2>
                <div class="form-group">
                    <label for="region">地區：</label>
                    <select id="region" name="region">
                        <option value="">選擇您的地區</option>
                        <option value="臺北市">臺北市</option>
                        <option value="新北市">新北市</option>
                        <option value="基隆市">基隆市</option>
                        <option value="桃園市">桃園市</option>
                        <option value="新竹市">新竹市</option>
                        <option value="新竹縣">新竹縣</option>
                        <option value="苗栗縣">苗栗縣</option>
                        <option value="臺中市">臺中市</option>
                        <option value="彰化縣">彰化縣</option>
                        <option value="南投縣">南投縣</option>
                        <option value="雲林縣">雲林縣</option>
                        <option value="嘉義市">嘉義市</option>
                        <option value="嘉義縣">嘉義縣</option>
                        <option value="臺南市">臺南市</option>
                        <option value="高雄市">高雄市</option>
                        <option value="屏東縣">屏東縣</option>
                        <option value="宜蘭縣">宜蘭縣</option>
                        <option value="花蓮縣">花蓮縣</option>
                        <option value="臺東縣">臺東縣</option>
                        <option value="澎湖縣">澎湖縣</option>
                        <option value="金門縣">金門縣</option>
                        <option value="連江縣">連江縣</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">日期:</label>
                    <input type="date" id="date">
                </div>
                <div class="form-group">
                    <label for="age">年齡：</label>
                    <input type="number" id="age" name="age" placeholder="輸入您的年齡" required>
                </div>
                <div class="form-group">
                    <label for="gender">性別：</label>
                    <select id="gender" name="gender">
                        <option value="">選擇您的性別</option>
                        <option value="男">男</option>
                        <option value="女">女</option>
                        <option value="其他">其他</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="zodiac">星座：</label>
                    <select id="zodiac" name="zodiac">
                        <option value="">選擇您的星座</option>
                        <option value="牡羊座">牡羊座</option>
                        <option value="金牛座">金牛座</option>
                        <option value="雙子座">雙子座</option>
                        <option value="巨蟹座">巨蟹座</option>
                        <option value="獅子座">獅子座</option>
                        <option value="處女座">處女座</option>
                        <option value="天秤座">天秤座</option>
                        <option value="天蠍座">天蠍座</option>
                        <option value="射手座">射手座</option>
                        <option value="魔羯座">魔羯座</option>
                        <option value="水瓶座">水瓶座</option>
                        <option value="雙魚座">雙魚座</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="activity">計劃活動:</label>
                    <select id="activity">
                        <option value="casual">日常活動</option>
                        <option value="work">上班/上學</option>
                        <option value="sports">運動</option>
                        <option value="formal">正式場合</option>
                        <option value="date">約會</option>
                        <option value="party">派對</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="style">偏好風格:</label>
                    <select id="style">
                        <option value="any">不限</option>
                        <option value="casual">休閒</option>
                        <option value="formal">正式</option>
                        <option value="sporty">運動</option>
                        <option value="business">商務</option>
                        <option value="vintage">復古</option>
                        <option value="minimalist">簡約</option>
                    </select>
                </div>
                <button id="btn-get-recommendation">獲取穿搭推薦</button>
            </div>
            
            <div id="recommendation-results" class="recommendation" style="display: none;">
                <div class="weather-display">
                    <div class="weather-icon" id="weather-icon">☀️</div>
                    <div>
                        <h3 id="weather-description">晴天，25°C</h3>
                        <p id="weather-feels">體感溫度：26°C</p>
                    </div>
                </div>
                
                <h3>從您的個人衣櫥推薦</h3>
                <div class="outfit" id="personal-outfit">
                    <!-- 個人衣櫥推薦將在這裡顯示 -->
                </div>
                
                <h3>從資料庫衣櫥推薦</h3>
                <div class="outfit" id="database-outfit">
                    <!-- 資料庫衣櫥推薦將在這裡顯示 -->
                </div>
                
                <div id="recommendation-tips">
                    <h3>穿搭建議</h3>
                    <ul id="tips-list">
                        <!-- 建議將在這裡顯示 -->
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 個人衣櫥頁面 -->
        <div id="personal-tab" class="tab-content">
            <div class="container">
                <h2>我的衣櫥</h2>
                <button id="btn-add-item">新增衣物</button>
                
                <div class="filter-bar">
                    <input type="text" id="personal-search" placeholder="搜尋衣物...">
                    <select id="personal-category">
                        <option value="all">所有分類</option>
                        <option value="tops">上衣</option>
                        <option value="bottoms">褲子/裙子</option>
                        <option value="outerwear">外套</option>
                        <option value="shoes">鞋子</option>
                        <option value="accessories">配件</option>
                    </select>
                    <select id="personal-season">
                        <option value="all">所有季節</option>
                        <option value="spring">春季</option>
                        <option value="summer">夏季</option>
                        <option value="autumn">秋季</option>
                        <option value="winter">冬季</option>
                    </select>
                </div>
                
                <div class="grid" id="personal-items">
                    <!-- 個人衣物將在這裡顯示 -->
                </div>
            </div>
        </div>
        
        <!-- 資料庫衣櫥頁面 -->
        <div id="database-tab" class="tab-content">
            <div class="container">
                <h2>資料庫衣櫥</h2>
                
                <div class="filter-bar">
                    <input type="text" id="database-search" placeholder="搜尋衣物...">
                    <select id="database-category">
                        <option value="all">所有分類</option>
                        <option value="tops">上衣</option>
                        <option value="bottoms">褲子/裙子</option>
                        <option value="outerwear">外套</option>
                        <option value="shoes">鞋子</option>
                        <option value="accessories">配件</option>
                    </select>
                    <select id="database-season">
                        <option value="all">所有季節</option>
                        <option value="spring">春季</option>
                        <option value="summer">夏季</option>
                        <option value="autumn">秋季</option>
                        <option value="winter">冬季</option>
                    </select>
                    <select id="database-style">
                        <option value="all">所有風格</option>
                        <option value="casual">休閒</option>
                        <option value="formal">正式</option>
                        <option value="sporty">運動</option>
                        <option value="business">商務</option>
                        <option value="vintage">復古</option>
                        <option value="minimalist">簡約</option>
                    </select>
                </div>
                
                <div class="grid" id="database-items">
                    <!-- 資料庫衣物將在這裡顯示 -->
                </div>
            </div>
        </div>
        
        <!-- 我的搭配頁面 -->
        <div id="outfit-tab" class="tab-content">
            <div class="container">
                <h2>我的搭配</h2>
                <button id="btn-create-outfit">創建新搭配</button>
                
                <div class="grid" id="saved-outfits">
                    <!-- 已保存的搭配將在這裡顯示 -->
                </div>
            </div>
        </div>
    </main>
    
    <!-- 新增衣物模態框 -->
    <div id="add-item-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>新增衣物</h2>
            <form id="add-item-form">
                <div class="form-group">
                    <label for="item-name">名稱:</label>
                    <input type="text" id="item-name" required>
                </div>
                <div class="form-group">
                    <label for="item-category">分類:</label>
                    <select id="item-category" required>
                        <option value="tops">上衣</option>
                        <option value="bottoms">褲子/裙子</option>
                        <option value="outerwear">外套</option>
                        <option value="shoes">鞋子</option>
                        <option value="accessories">配件</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="item-type">類型:</label>
                    <input type="text" id="item-type" placeholder="例如：T恤、毛衣、牛仔褲等">
                </div>
                <div class="form-group">
                    <label for="item-color">顏色:</label>
                    <input type="text" id="item-color" required>
                </div>
                <div class="form-group">
                    <label for="item-season">適合季節:</label>
                    <select id="item-season" required>
                        <option value="spring">春季</option>
                        <option value="summer">夏季</option>
                        <option value="autumn">秋季</option>
                        <option value="winter">冬季</option>
                        <option value="all">全季節</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="item-style">風格:</label>
                    <select id="item-style" required>
                        <option value="casual">休閒</option>
                        <option value="formal">正式</option>
                        <option value="sporty">運動</option>
                        <option value="business">商務</option>
                        <option value="vintage">復古</option>
                        <option value="minimalist">簡約</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="item-temp-min">最低適合溫度 (°C):</label>
                    <input type="number" id="item-temp-min" min="-20" max="40" required>
                </div>
                <div class="form-group">
                    <label for="item-temp-max">最高適合溫度 (°C):</label>
                    <input type="number" id="item-temp-max" min="-20" max="40" required>
                </div>
                <div class="form-group">
                    <label for="item-weather">適合天氣:</label>
                    <select id="item-weather" multiple>
                        <option value="sunny">晴天</option>
                        <option value="cloudy">多雲</option>
                        <option value="rainy">雨天</option>
                        <option value="snowy">下雪</option>
                        <option value="windy">多風</option>
                    </select>
                    <small>按住 Ctrl 鍵可選擇多項</small>
                </div>
                <div class="form-group">
                    <label for="item-image">圖片 URL (可選):</label>
                    <input type="text" id="item-image" placeholder="http://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label for="item-notes">備註:</label>
                    <textarea id="item-notes" rows="3"></textarea>
                </div>
                <button type="submit">保存</button>
            </form>
        </div>
    </div>
    
    <!-- 創建搭配模態框 -->
    <div id="create-outfit-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>創建新搭配</h2>
            <div class="form-group">
                <label for="outfit-name">搭配名稱:</label>
                <input type="text" id="outfit-name" required>
            </div>
            <div class="form-group">
                <label>選擇衣物:</label>
                <div class="filter-bar">
                    <select id="outfit-category-filter">
                        <option value="all">所有分類</option>
                        <option value="tops">上衣</option>
                        <option value="bottoms">褲子/裙子</option>
                        <option value="outerwear">外套</option>
                        <option value="shoes">鞋子</option>
                        <option value="accessories">配件</option>
                    </select>
                </div>
                <div class="grid" id="outfit-selection">
                    <!-- 可選衣物將在這裡顯示 -->
                </div>
            </div>
            <div class="form-group">
                <label>已選衣物:</label>
                <div class="outfit" id="outfit-selected">
                    <!-- 已選衣物將在這裡顯示 -->
                </div>
            </div>
            <button id="btn-save-outfit">保存搭配</button>
        </div>
    </div>
    
    <script>
        // 設置今天日期為默認值
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            document.getElementById('date').value = dateString;
            
            // 初始化頁面
            loadPersonalWardrobe();
            loadDatabaseWardrobe();
            loadSavedOutfits();
            
            // 模擬天氣數據
            simulateWeatherData();
        });
        
        // 標籤頁切換
        document.getElementById('btn-weather').addEventListener('click', function() {
            setActiveTab('weather-tab');
            this.classList.add('active');
        });
        
        document.getElementById('btn-personal').addEventListener('click', function() {
            setActiveTab('personal-tab');
            this.classList.add('active');
        });
        
        document.getElementById('btn-database').addEventListener('click', function() {
            setActiveTab('database-tab');
            this.classList.add('active');
        });
        
        document.getElementById('btn-outfit').addEventListener('click', function() {
            setActiveTab('outfit-tab');
            this.classList.add('active');
        });
        
        function setActiveTab(tabId) {
            // 重置所有標籤頁和按鈕
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('nav button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 設置活躍標籤頁
            document.getElementById(tabId).classList.add('active');
        }
        
        // 模態框操作
        document.getElementById('btn-add-item').addEventListener('click', function() {
            document.getElementById('add-item-modal').style.display = 'block';
        });
        
        document.getElementById('btn-create-outfit').addEventListener('click', function() {
            document.getElementById('create-outfit-modal').style.display = 'block';
            populateOutfitSelection();
        });
        
        document.querySelectorAll('.close').forEach(function(closeBtn) {
            closeBtn.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });
        
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });
        
        // 表單提交處理
        document.getElementById('add-item-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 獲取表單數據
            const item = {
                id: 'p' + Date.now(),
                name: document.getElementById('item-name').value,
                category: document.getElementById('item-category').value,
                type: document.getElementById('item-type').value,
                color: document.getElementById('item-color').value,
                season: document.getElementById('item-season').value,
                style: document.getElementById('item-style').value,
                tempMin: parseInt(document.getElementById('item-temp-min').value),
                tempMax: parseInt(document.getElementById('item-temp-max').value),
                weather: Array.from(document.getElementById('item-weather').selectedOptions).map(opt => opt.value),
                image: document.getElementById('item-image').value || `/api/placeholder/200/200?text=${encodeURIComponent(document.getElementById('item-name').value)}`,
                notes: document.getElementById('item-notes').value
            };
            
            // 保存到本地存儲
            let wardrobe = JSON.parse(localStorage.getItem('personalWardrobe')) || [];
            wardrobe.push(item);
            localStorage.setItem('personalWardrobe', JSON.stringify(wardrobe));
            
            // 更新顯示
            loadPersonalWardrobe();
            
            // 關閉模態框
            document.getElementById('add-item-modal').style.display = 'none';
            this.reset();
        });
        
        document.getElementById('btn-save-outfit').addEventListener('click', function() {
            const outfitName = document.getElementById('outfit-name').value;
            if (!outfitName) {
                alert('請輸入搭配名稱');
                return;
            }
            
            // 獲取已選衣物
            const selectedItems = document.querySelectorAll('#outfit-selected .outfit-item');
            if (selectedItems.length === 0) {
                alert('請至少選擇一件衣物');
                return;
            }
            
            const items = Array.from(selectedItems).map(item => item.dataset.id);
            
            // 保存搭配
            const outfit = {
                id: 'o' + Date.now(),
                name: outfitName,
                items: items,
                created: new Date().toISOString()
            };
            
            let outfits = JSON.parse(localStorage.getItem('savedOutfits')) || [];
            outfits.push(outfit);
            localStorage.setItem('savedOutfits', JSON.stringify(outfits));
            
            // 更新顯示
            loadSavedOutfits();
            
            // 關閉模態框
            document.getElementById('create-outfit-modal').style.display = 'none';
            document.getElementById('outfit-name').value = '';
            document.getElementById('outfit-selected').innerHTML = '';
        });
        
        // 獲取天氣推薦
        document.getElementById('btn-get-recommendation').addEventListener('click', function() {
            // 獲取用戶輸入
            const location = document.getElementById('location').value;
            const date = document.getElementById('date').value;
            const manualWeather = document.getElementById('manual-weather').value;
            const manualTemp = document.getElementById('manual-temp').value;
            const activity = document.getElementById('activity').value;
            const style = document.getElementById('style').value;
            
            // 模擬天氣數據
            let weatherData = getWeatherData(location, date);
            
            // 如果有手動設置，覆蓋模擬數據
            if (manualWeather) {
                weatherData.condition = manualWeather;
            }
            if (manualTemp) {
                weatherData.temperature = parseInt(manualTemp);
            }
            
            // 更新天氣顯示
            updateWeatherDisplay(weatherData);
            
            // 生成推薦
            generateRecommendations(weatherData, activity, style);
            
            // 顯示推薦結果
            document.getElementById('recommendation-results').style.display = 'block';
        });
        
        // 個人衣櫥搜索和篩選
        document.getElementById('personal-search').addEventListener('input', function() {
            filterPersonalWardrobe();
        });
        
        document.getElementById('personal-category').addEventListener('change', function() {
            filterPersonalWardrobe();
        });
        
        document.getElementById('personal-season').addEventListener('change', function() {
            filterPersonalWardrobe();
        });
        
        // 資料庫衣櫥搜索和篩選
        document.getElementById('database-search').addEventListener('input', function() {
            filterDatabaseWardrobe();
        });
        
        document.getElementById('database-category').addEventListener('change', function() {
            filterDatabaseWardrobe();
        });
        
        document.getElementById('database-season').addEventListener('change', function() {
            filterDatabaseWardrobe();
        });
        
        document.getElementById('database-style').addEventListener('change', function() {
            filterDatabaseWardrobe();
        });
        
        // 搭配衣物分類篩選
        document.getElementById('outfit-category-filter').addEventListener('change', function() {
            filterOutfitSelection();
        });
        
        // 加載個人衣櫥
        function loadPersonalWardrobe() {
            const container = document.getElementById('personal-items');
            container.innerHTML = '';
            
            let wardrobe = JSON.parse(localStorage.getItem('personalWardrobe')) || [];
            
            if (wardrobe.length === 0) {
                // 如果沒有衣物，添加一些示例
                wardrobe = generateSamplePersonalItems();
                localStorage.setItem('personalWardrobe', JSON.stringify(wardrobe));
            }
            
            wardrobe.forEach(item => {
                const card = createItemCard(item, true);
                container.appendChild(card);
            });
        }
        
        // 加載資料庫衣櫥
        function loadDatabaseWardrobe() {
            const container = document.getElementById('database-items');
            container.innerHTML = '';
            
            // 這裡我們使用固定的資料庫衣物
            const databaseItems = generateDatabaseItems();
            
            }